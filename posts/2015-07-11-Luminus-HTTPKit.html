<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="me" href="https://mastodon.social/@yogthos">
    <link rel="me" href="https://mas.to/@yogthos">
    <link rel="me" href="https://social.marxist.network/@yogthos">
    <title>(iterate think thoughts): Luminus is Moving -&gt; HTTP Kit -&gt; Immutant</title>
    <meta name="description" content="Dmitri&#39;s blog about programming, Clojure, and software development">
    <meta name="keywords" content="">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="icon" type="image/png" href="/img/favicon.png">
    <link href="/css/site.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css" media="(prefers-color-scheme: light)" id="hljs-light">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/base16/tomorrow-night.min.css" media="(prefers-color-scheme: dark)" id="hljs-dark">
    <script>
    (function(){var t=localStorage.getItem('theme');if(t){document.documentElement.setAttribute('data-theme',t);var l=document.getElementById('hljs-light'),d=document.getElementById('hljs-dark');if(l&&d){if(t==='dark'){l.media='not all';d.media='all'}else{l.media='all';d.media='not all'}}}})();
    </script>
</head>
<body>

<aside id="sidebar">

    <p id="logo">
        <a title="(iterate think thoughts)" href="/index.html">
            <span class="text"><span class="paren">(</span><span class="fn">iterate</span>
                <br>
                <span class="text">&nbsp;&nbsp;think</span>
                <br>
                <span class="text">&nbsp;&nbsp;thoughts<span class="paren">)</span>
            </span>
        </a>
    </p>

    <nav id="menucont" class="bodycontainer">
        <button class="menu-toggle" aria-label="Toggle menu">
            <span class="hamburger"></span>
            <span class="menu-label">Menu</span>
        </button>
        <ul class="menu">
            <li ><a title="Home" href="/index.html">Home</a></li>
            <li ><a title="Archives" href="/archives.html">Archives</a></li>
            
            <li ><a title="Tags" href="/tags.html">Tags</a></li>
            
            
            <li >
                <a href="/pages/about.html">About</a>
            </li>
            
            <li><a title="RSS" href="/feed.xml">RSS</a></li>
        </ul>
    </nav>

    <div class="theme-toggle-wrapper">
        <button class="theme-toggle" aria-label="Toggle dark mode">
            <svg class="icon-sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"/></svg>
            <svg class="icon-moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 7a7 7 0 0 0 12 4.9v.1c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2h.1A6.979 6.979 0 0 0 10 7zm-6 5a8 8 0 0 0 15.062 3.762A9 9 0 0 1 8.238 4.938 7.999 7.999 0 0 0 4 12z"/></svg>
            <span>Theme</span>
        </button>
    </div>
</aside>

<main id="content">
    
<div id="post">
    <article>
<div class="post-header">
    <div id="post-meta" class="row">
        <strong>July 11, 2015</strong>
        
    </div>
    <h1><a class="post-title" href="/posts/2015-07-11-Luminus-HTTPKit.html">Luminus is Moving -&gt; HTTP Kit -&gt; Immutant</a></h1>
</div>
<div>
    
     <h2 id="update">Update</h2><p>After having some discussions with the author of HTTP Kit and doing a deeper evaluation of Immutant I'm switching to it as the default.</p><p>It turns out that Immutant addresses all of the concerns as well as HTTP Kit while having the benefit of a larger team maintaining it.</p><p>The version 2 of Immutant is modular and provides a minimal runtime that has low overhead. The websocket support works similarly to HTTP Kit and is now documented as well. Unlike Jetty 9 adapters with websocket support, Immutant builds do not require JRE 8 to run.</p><p>Finally, Immutant provides many useful pluggable libraries for caching, message queues, and scheduling.</p><h2 id="end&#95;update">End Update</h2> <p>One of the guiding principles for Luminus has been to provide a great user experience out of the box. Having to go through a tedious setup before you can focus on the problem you actually want to solve should be unnecessary.</p><p>Luminus removes the burden or having to find the libraries, configure middleware, and add the common boilerplate. The application generated by the template is ready for  deployment out of the box. The only part that's missing is the domain logic for your application.</p><p>As the project evolves I'm always looking for new ways to streamline user experience. Clojure web ecosystem is rapidly evolving along with the best practices and tools. Luminus aims to keep abreast of these changes and to provide a reference implementation for Ring based applications.</p><p>Recently, Luminus moved to using <a href='https://github.com/yogthos/migratus'>Migratus</a> for handling database migrations for reasons discussed in <a href='http://yogthos.net/posts/2015-06-29-Luminus-Migratus.html'>this</a> post. This time we'll look at the reasons for moving to HTTP Kit as the default server.</p><p>Up to now, Luminus applications would use the version of Jetty packaged by the Ring dependency. The major drawback of the default Jetty adapter is its lack of support for websockets. After evaluating the alternatives I settled on HTTP Kit as the default server for Luminus.</p><p>HTTP Kit is built on top of <a href='https://en.wikipedia.org/wiki/Non-blocking_I/O_(Java&#41;'>NIO</a>. It combines <a href='https://github.com/ptaoussanis/clojure-web-server-benchmarks'>high performance</a> when handling a large number of connections with <a href='http://www.http-kit.org/600k-concurrent-connection-http-kit.html'>low memory overhead</a> per connection. Finally, it provides a Ring/Compojure compatible API for working with <a href='https://en.wikipedia.org/wiki/WebSocket'>websockets</a> that's now <a href='http://www.luminusweb.net/docs/websockets.md'>part</a> of the official Luminus documentation.</p><p>While HTTP Kit is the default, all the major HTTP servers are supported via their respective flags:</p><ul><li><code>+alpeh</code> - <a href='https://github.com/ztellman/aleph'>Aleph</a> is a stream based server built on top of Netty</li><li><code>+immutant</code> - <a href='http://immutant.org/'>Immutant</a> is a <a href='http://www.jboss.org/'>JBoss</a> based server with many built in features such as messaging, scheduling and caching</li><li><code>+jetty</code> - <a href='https://github.com/mpenet/jet'>Jet</a> is the Ring Jetty adapter with websocket support</li></ul><p>Another major change is that the <a href='https://github.com/weavejester/lein-ring'>lein-ring</a> plugin is no longer used by default. Since the plugin is based on the Jetty based <a href='https://github.com/weavejester/ring-server'>ring-server</a> library, a separate workflow was required for the alternative HTTP servers.</p><p>Instead, the template now provides its own <code>core</code> namespace that manages the server lifecycle. This provides a consistent experience regardless of the server being used. The <code>lein-ring</code> plugin is now part of the <code>+war</code> profile used to generate server independent WAR archives for deployment to application servers such as <a href='http://tomcat.apache.org/'>Apache Tomcat</a>.</p>
</div>

<div id="post-tags">
    <br/>
    <b>Tags: </b>
    
    <a href="/clojure.html">clojure</a>
    
    <a href="/luminus.html">luminus</a>
    
</div>

<br/>
</article>

    <div id="prev-next">
        
        <a class="button" href="/posts/2015-10-01-Compojure-API.html">&laquo; Building services with Duct and compojure-api</a>
        
        
        <a class="right button" href="/posts/2015-07-07-Data-Focused.html">Data Focused &raquo;</a>
        
    </div>

    


</div>

    <hr/>
    <footer id="footercont">Copyright &copy; 2026 Dmitri Sotnikov
        <p>Powered by <a href="http://cryogenweb.org">Cryogen</a></p>
    </footer>
</main>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="/js/scripts.js" type="text/javascript"></script>


</body>
</html>
